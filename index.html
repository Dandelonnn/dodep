<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé≤ –ê–≤—Ç–æ-–∫–∞–∑–∏–Ω–æ –¥–ª—è –¥—Ä—É–∑–µ–π</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #1a1a2e;
            color: white;
            text-align: center;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #16213e;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            color: #f9c74f;
            margin-bottom: 30px;
        }
        
        .game-area {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .player {
            background-color: #0f3460;
            padding: 20px;
            border-radius: 8px;
            width: 45%;
            margin-bottom: 20px;
        }
        
        .dice {
            font-size: 80px;
            margin: 20px 0;
        }
        
        button {
            background-color: #4cc9f0;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }
        
        button:hover {
            background-color: #4361ee;
            transform: scale(1.05);
        }
        
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .scoreboard {
            background-color: #0f3460;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .score {
            font-size: 24px;
            font-weight: bold;
            color: #f9c74f;
        }
        
        .history {
            margin-top: 30px;
            background-color: #0f3460;
            padding: 15px;
            border-radius: 8px;
        }
        
        #historyLog {
            max-height: 200px;
            overflow-y: auto;
            text-align: left;
            padding: 10px;
        }
        
        .lobby {
            margin-bottom: 30px;
        }
        
        input {
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
            margin-right: 10px;
        }
        
        .connection-status {
            margin: 10px 0;
            font-weight: bold;
        }
        
        .connected {
            color: #4ade80;
        }
        
        .waiting {
            color: #fbbf24;
        }
        
        #waitingPlayers {
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé≤ –ê–≤—Ç–æ-–∫–∞–∑–∏–Ω–æ –¥–ª—è –¥—Ä—É–∑–µ–π</h1>
        
        <div class="lobby" id="lobby">
            <input type="text" id="playerName" placeholder="–í–∞—à–µ –∏–º—è">
            <button id="joinQueue">–ù–∞–π—Ç–∏ –∏–≥—Ä—É</button>
            <div id="connectionStatus" class="connection-status">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ</div>
            <div id="waitingPlayers">–û–∂–∏–¥–∞—é—â–∏—Ö –∏–≥—Ä–æ–∫–æ–≤: <span id="playersCount">0</span></div>
        </div>
        
        <div id="gameContent" style="display: none;">
            <div class="game-area">
                <div class="player" id="player1">
                    <h2 id="player1Name">–ò–≥—Ä–æ–∫ 1</h2>
                    <div class="dice">üé≤</div>
                    <p>–û—á–∫–∏: <span class="score" id="score1">0</span></p>
                    <button id="roll1">–ë—Ä–æ—Å–∏—Ç—å –∫–æ—Å—Ç–∏</button>
                </div>
                
                <div class="player" id="player2">
                    <h2 id="player2Name">–ò–≥—Ä–æ–∫ 2</h2>
                    <div class="dice">üé≤</div>
                    <p>–û—á–∫–∏: <span class="score" id="score2">0</span></p>
                    <button id="roll2">–ë—Ä–æ—Å–∏—Ç—å –∫–æ—Å—Ç–∏</button>
                </div>
            </div>
            
            <div class="scoreboard">
                <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <p>–ü–æ–±–µ–¥: <span id="player1NameShort"></span> - <span id="wins1">0</span> | 
                <span id="player2NameShort"></span> - <span id="wins2">0</span></p>
                <button id="newGame">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <button id="leaveGame">–ü–æ–∫–∏–Ω—É—Ç—å –∏–≥—Ä—É</button>
            </div>
            
            <div class="history">
                <h2>–ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</h2>
                <div id="historyLog"></div>
            </div>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let playerId = Math.random().toString(36).substr(2, 9);
        let playerName = "";
        let gameId = "";
        let isHost = false;
        let currentPlayerTurn = "";
        let gameActive = false;
        let scores = { player1: 0, player2: 0 };
        let wins = { player1: 0, player2: 0 };
        let players = { player1: null, player2: null };
        let socket = null;
        let queueCount = 0;
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const playerNameInput = document.getElementById('playerName');
        const joinQueueBtn = document.getElementById('joinQueue');
        const connectionStatus = document.getElementById('connectionStatus');
        const gameContent = document.getElementById('gameContent');
        const lobby = document.getElementById('lobby');
        const playersCountElement = document.getElementById('playersCount');
        
        // –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π
        joinQueueBtn.addEventListener('click', joinQueue);
        document.getElementById('roll1').addEventListener('click', () => rollDice('player1'));
        document.getElementById('roll2').addEventListener('click', () => rollDice('player2'));
        document.getElementById('newGame').addEventListener('click', startNewGame);
        document.getElementById('leaveGame').addEventListener('click', leaveGame);
        
        // –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –æ—á–µ—Ä–µ–¥–∏
        function joinQueue() {
            playerName = playerNameInput.value.trim() || "–ò–≥—Ä–æ–∫ " + Math.floor(Math.random() * 100);
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
            updateConnectionStatus("–ò—â–µ–º —Å–æ–ø–µ—Ä–Ω–∏–∫–∞...", false);
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–æ –±—ã WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º setTimeout
            setTimeout(() => {
                // 50% —à–∞–Ω—Å —Å—Ç–∞—Ç—å —Ö–æ—Å—Ç–æ–º
                isHost = Math.random() > 0.5;
                gameId = "demo-" + Math.random().toString(36).substr(2, 6);
                
                if (isHost) {
                    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É
                    players.player1 = { id: playerId, name: playerName, score: 0 };
                    updateConnectionStatus("–û–∂–∏–¥–∞–µ–º –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞...", false);
                } else {
                    // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ–º—Å—è –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–≥—Ä–µ
                    players.player2 = { id: playerId, name: playerName, score: 0 };
                    startGame();
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ "–æ–∂–∏–¥–∞—é—â–∏—Ö" –∏–≥—Ä–æ–∫–æ–≤ (–¥–ª—è –¥–µ–º–æ)
                setInterval(() => {
                    queueCount = Math.floor(Math.random() * 10);
                    playersCountElement.textContent = queueCount;
                }, 2000);
            }, 1500);
        }
        
        // –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
        function startGame() {
            if (isHost) {
                // –ï—Å–ª–∏ –º—ã —Ö–æ—Å—Ç, –∂–¥–µ–º –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞
                setTimeout(() => {
                    // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞
                    players.player2 = { 
                        id: "demo-opponent", 
                        name: "–°–æ–ø–µ—Ä–Ω–∏–∫ " + Math.floor(Math.random() * 100), 
                        score: 0 
                    };
                    startGame();
                }, 3000);
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            lobby.style.display = "none";
            gameContent.style.display = "block";
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–º–µ–Ω–∞ –∏–≥—Ä–æ–∫–æ–≤
            document.getElementById('player1Name').textContent = players.player1?.name || "–ò–≥—Ä–æ–∫ 1";
            document.getElementById('player2Name').textContent = players.player2?.name || "–ò–≥—Ä–æ–∫ 2";
            document.getElementById('player1NameShort').textContent = players.player1?.name || "–ò–≥—Ä–æ–∫ 1";
            document.getElementById('player2NameShort').textContent = players.player2?.name || "–ò–≥—Ä–æ–∫ 2";
            
            // –ù–∞—á–∏–Ω–∞–µ–º –∏–≥—Ä—É
            currentPlayerTurn = players.player1.id;
            gameActive = true;
            updateConnectionStatus("–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!", true);
            addToHistory(`–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –ü–µ—Ä–≤—ã–º —Ö–æ–¥–∏—Ç ${players.player1.name}`);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
            updateButtons();
        }
        
        // –ë—Ä–æ—Å–æ–∫ –∫–æ—Å—Ç–µ–π
        function rollDice(playerType) {
            if (!gameActive) return;
            
            const roll1 = Math.floor(Math.random() * 6) + 1;
            const roll2 = Math.floor(Math.random() * 6) + 1;
            const total = roll1 + roll2;
            
            // –≠–º–æ–¥–∑–∏ –∫–æ—Å—Ç–µ–π (1-6)
            const diceEmojis = ['‚öÄ', '‚öÅ', '‚öÇ', '‚öÉ', '‚öÑ', '‚öÖ'];
            const diceResult = diceEmojis[roll1 - 1] + diceEmojis[roll2 - 1];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫—É–±–∏–∫–∏
            document.querySelector(`#${playerType} .dice`).textContent = diceResult;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏
            if (playerType === 'player1') {
                scores.player1 += total;
                document.getElementById('score1').textContent = scores.player1;
            } else {
                scores.player2 += total;
                document.getElementById('score2').textContent = scores.player2;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–±–µ–¥—É
            const newScore = playerType === 'player1' ? scores.player1 : scores.player2;
            if (newScore >= 50) {
                gameActive = false;
                if (playerType === 'player1') {
                    wins.player1++;
                    document.getElementById('wins1').textContent = wins.player1;
                } else {
                    wins.player2++;
                    document.getElementById('wins2').textContent = wins.player2;
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
                const winnerName = playerType === 'player1' ? players.player1.name : players.player2.name;
                addToHistory(`üéâ ${winnerName} –ø–æ–±–µ–∂–¥–∞–µ—Ç —Å ${newScore} –æ—á–∫–∞–º–∏!`);
            } else {
                // –ü–µ—Ä–µ–¥–∞–µ–º —Ö–æ–¥ –¥—Ä—É–≥–æ–º—É –∏–≥—Ä–æ–∫—É
                currentPlayerTurn = playerType === 'player1' ? players.player2.id : players.player1.id;
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
                const playerName = playerType === 'player1' ? players.player1.name : players.player2.name;
                addToHistory(`${playerName} –≤—ã–±—Ä–æ—Å–∏–ª ${roll1} –∏ ${roll2} (–≤—Å–µ–≥–æ ${total})`);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
                updateButtons();
            }
        }
        
        // –ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É
        function startNewGame() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç
            scores = { player1: 0, player2: 0 };
            document.getElementById('score1').textContent = "0";
            document.getElementById('score2').textContent = "0";
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫—É–±–∏–∫–∏
            document.querySelector('#player1 .dice').textContent = "üé≤";
            document.querySelector('#player2 .dice').textContent = "üé≤";
            
            // –ù–∞—á–∏–Ω–∞–µ–º –∏–≥—Ä—É
            currentPlayerTurn = players.player1.id;
            gameActive = true;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
            addToHistory(`–ù–∞—á–∞—Ç–∞ –Ω–æ–≤–∞—è –∏–≥—Ä–∞! –ü–µ—Ä–≤—ã–º —Ö–æ–¥–∏—Ç ${players.player1.name}`);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
            updateButtons();
        }
        
        // –ü–æ–∫–∏–Ω—É—Ç—å –∏–≥—Ä—É
        function leaveGame() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            resetGame();
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –ª–æ–±–±–∏
            lobby.style.display = "block";
            gameContent.style.display = "none";
            updateConnectionStatus("–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ");
        }
        
        // –°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É
        function resetGame() {
            scores = { player1: 0, player2: 0 };
            players = { player1: null, player2: null };
            gameActive = false;
            currentPlayerTurn = "";
            document.getElementById('historyLog').innerHTML = "";
        }
        
        // –î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
        function addToHistory(message) {
            const entry = document.createElement('p');
            entry.textContent = message;
            document.getElementById('historyLog').prepend(entry);
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        function updateConnectionStatus(message, isConnected = false) {
            connectionStatus.textContent = message;
            connectionStatus.className = "connection-status " + (isConnected ? "connected" : "waiting");
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –±—Ä–æ—Å–∫–∞
        function updateButtons() {
            document.getElementById('roll1').disabled = 
                currentPlayerTurn !== playerId || 
                playerId !== players.player1?.id || 
                !gameActive;
            
            document.getElementById('roll2').disabled = 
                currentPlayerTurn !== playerId || 
                playerId !== players.player2?.id || 
                !gameActive;
        }
        
        // –ò–º–∏—Ç–∞—Ü–∏—è WebSocket (–¥–ª—è –¥–µ–º–æ)
        function simulateWebSocket() {
            setInterval(() => {
                if (gameActive && !isHost && Math.random() > 0.7) {
                    // –ò–º–∏—Ç–∏—Ä—É–µ–º —Ö–æ–¥ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
                    setTimeout(() => {
                        if (gameActive && currentPlayerTurn !== playerId) {
                            rollDice(players.player1.id === playerId ? 'player2' : 'player1');
                        }
                    }, 1000 + Math.random() * 2000);
                }
            }, 3000);
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–º–∏—Ç–∞—Ü–∏—é WebSocket
        simulateWebSocket();
    </script>
</body>
</html>